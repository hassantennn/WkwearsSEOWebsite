import{j as e}from"./jsx-runtime-BJrenFx_.js";import{j as l,J as S}from"./index-C3c9A_Hk.js";import{r as p,L as A}from"./chunk-D4RADZKF-Dyetzg4o.js";import{u as U,P as k}from"./ProductPrice-bqsdTYHv.js";import{u as q}from"./variants-DmSdMkTR.js";import{I as v}from"./Image-B_TZjruE.js";import{M as D}from"./Money-APOJR4kl.js";function R({layout:t,line:n}){var y,C;const{id:s,merchandise:i}=n,{product:a,title:r,image:c,selectedOptions:d}=i,m=q(a.handle,d),{close:j}=U();let o=((y=a.images)==null?void 0:y.nodes)??[];!o.length&&c&&(o=[{url:c.url,altText:c.altText}]);const[x,u]=p.useState(0),f=o[x];return e.jsxs("li",{className:"cart-line",children:[e.jsxs("div",{className:"cart-line-gallery",children:[f&&e.jsx(v,{data:f,className:"gallery-main-image",loading:"lazy"}),e.jsx("div",{className:"gallery-thumbnails",children:o.map((h,b)=>e.jsx("button",{className:`gallery-thumbnail ${b===x?"active":""}`,onClick:()=>u(b),children:e.jsx(v,{data:h,width:60,height:60,loading:"lazy"})},h.url))})]}),e.jsxs("div",{className:"cart-line-details",children:[e.jsx(A,{prefetch:"intent",to:m,onClick:()=>{t==="aside"&&j()},children:e.jsx("p",{children:e.jsx("strong",{children:a.title})})}),e.jsx(k,{price:(C=n==null?void 0:n.cost)==null?void 0:C.totalAmount}),e.jsx("ul",{children:d.map(h=>e.jsx("li",{children:e.jsxs("small",{children:[h.name,": ",h.value]})},h.name))}),e.jsx(T,{line:n})]})]},s)}function T({line:t}){if(!t||typeof(t==null?void 0:t.quantity)>"u")return null;const{id:n,quantity:s,isOptimistic:i}=t,a=Number(Math.max(0,s-1).toFixed(0)),r=Number((s+1).toFixed(0));return e.jsxs("div",{className:"cart-line-quantity",children:[e.jsxs("small",{children:["Quantity: ",s,"   "]}),e.jsx(g,{lines:[{id:n,quantity:a}],children:e.jsx("button",{"aria-label":"Decrease quantity",disabled:s<=1||!!i,name:"decrease-quantity",value:a,children:e.jsx("span",{children:"− "})})})," ",e.jsx(g,{lines:[{id:n,quantity:r}],children:e.jsx("button",{"aria-label":"Increase quantity",name:"increase-quantity",value:r,disabled:!!i,children:e.jsx("span",{children:"+"})})})," ",e.jsx(G,{lineIds:[n],disabled:!!i})]})}function G({lineIds:t,disabled:n}){return e.jsx(l,{fetcherKey:L(t),route:"/cart",action:l.ACTIONS.LinesRemove,inputs:{lineIds:t},children:e.jsx("button",{disabled:n,type:"submit",children:"Remove"})})}function g({children:t,lines:n}){const s=n.map(i=>i.id);return e.jsx(l,{fetcherKey:L(s),route:"/cart",action:l.ACTIONS.LinesUpdate,inputs:{lines:n},children:t})}function L(t){return[l.ACTIONS.LinesUpdate,...t].join("-")}function O({cart:t,layout:n}){var i,a,r;const s=n==="page"?"cart-summary-page":"cart-summary-aside";return e.jsxs("div",{"aria-labelledby":"cart-summary",className:s,children:[e.jsx("h4",{children:"Totals"}),e.jsxs("dl",{className:"cart-subtotal",children:[e.jsx("dt",{children:"Subtotal"}),e.jsx("dd",{children:(a=(i=t.cost)==null?void 0:i.subtotalAmount)!=null&&a.amount?e.jsx(D,{data:(r=t.cost)==null?void 0:r.subtotalAmount}):"-"})]}),e.jsx(w,{discountCodes:t.discountCodes}),e.jsx(B,{giftCardCodes:t.appliedGiftCards}),e.jsx(Q,{checkoutUrl:t.checkoutUrl})]})}function Q({checkoutUrl:t}){return t?e.jsxs("div",{children:[e.jsx("a",{href:t,target:"_self",children:e.jsx("p",{children:"Continue to Checkout →"})}),e.jsx("br",{})]}):null}function w({discountCodes:t}){var s;const n=((s=t==null?void 0:t.filter(i=>i.applicable))==null?void 0:s.map(({code:i})=>i))||[];return e.jsxs("div",{children:[e.jsx("dl",{hidden:!n.length,children:e.jsxs("div",{children:[e.jsx("dt",{children:"Discount(s)"}),e.jsx(N,{children:e.jsxs("div",{className:"cart-discount",children:[e.jsx("code",{children:n==null?void 0:n.join(", ")})," ",e.jsx("button",{children:"Remove"})]})})]})}),e.jsx(N,{discountCodes:n,children:e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"discountCode",placeholder:"Discount code"})," ",e.jsx("button",{type:"submit",children:"Apply"})]})})]})}function N({discountCodes:t,children:n}){return e.jsx(l,{route:"/cart",action:l.ACTIONS.DiscountCodesUpdate,inputs:{discountCodes:t||[]},children:n})}function B({giftCardCodes:t}){const n=p.useRef([]),s=p.useRef(null),i=(t==null?void 0:t.map(({lastCharacters:c})=>`***${c}`))||[];function a(c){const d=c.replace(/\s/g,"");n.current.includes(d)||n.current.push(d),s.current.value=""}function r(){n.current=[]}return e.jsxs("div",{children:[e.jsx("dl",{hidden:!i.length,children:e.jsxs("div",{children:[e.jsx("dt",{children:"Applied Gift Card(s)"}),e.jsx(I,{children:e.jsxs("div",{className:"cart-discount",children:[e.jsx("code",{children:i==null?void 0:i.join(", ")})," ",e.jsx("button",{onSubmit:()=>r,children:"Remove"})]})})]})}),e.jsx(I,{giftCardCodes:n.current,saveAppliedCode:a,children:e.jsxs("div",{children:[e.jsx("input",{type:"text",name:"giftCardCode",placeholder:"Gift card code",ref:s})," ",e.jsx("button",{type:"submit",children:"Apply"})]})})]})}function I({giftCardCodes:t,saveAppliedCode:n,children:s}){return e.jsx(l,{route:"/cart",action:l.ACTIONS.GiftCardCodesUpdate,inputs:{giftCardCodes:t||[]},children:i=>{var r;const a=(r=i.formData)==null?void 0:r.get("giftCardCode");return a&&n&&n(a),s}})}function H({layout:t,cart:n}){var d,m,j,o,x;const s=S(n),i=!!((m=(d=s==null?void 0:s.lines)==null?void 0:d.nodes)!=null&&m.length),r=`cart-main ${s&&!!((o=(j=s==null?void 0:s.discountCodes)==null?void 0:j.filter(u=>u.applicable))!=null&&o.length)?"with-discount":""}`,c=s!=null&&s.totalQuantity?s.totalQuantity>0:!1;return e.jsxs("div",{className:r,children:[e.jsx(F,{hidden:i,layout:t}),e.jsxs("div",{className:"cart-details",children:[e.jsx("div",{"aria-labelledby":"cart-lines",children:e.jsx("ul",{children:(((x=s==null?void 0:s.lines)==null?void 0:x.nodes)??[]).map(u=>e.jsx(R,{line:u,layout:t},u.id))})}),c&&e.jsx(O,{cart:s,layout:t})]})]})}function F({hidden:t=!1}){const{close:n}=U();return e.jsxs("div",{hidden:t,children:[e.jsx("br",{}),e.jsx("p",{children:"Looks like you haven’t added anything yet, let’s get you started!"}),e.jsx("br",{}),e.jsx(A,{to:"/collections",onClick:n,prefetch:"viewport",children:"Continue shopping →"})]})}export{H as C};
